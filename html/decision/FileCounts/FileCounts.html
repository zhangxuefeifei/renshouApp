<!DOCTYPE HTML>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="maximum-scale=1.0, minimum-scale=1.0, user-scalable=0, initial-scale=1.0, width=device-width" />
    <meta name="format-detection" content="telephone=no, email=no, date=no, address=no">
    <title>档案页面</title>
    <link rel="stylesheet" type="text/css" href="../../../css/aui1.css" />
    <link rel=stylesheet type=text/css href=../../../css/rolldate.css />
    <style>
        html,
        body {
            width: 100%;
            height: 100%;
            background-color: #FFF;
            -webkit-box-orient: vertical;
            -webkit-flex-flow: column;
            flex-flow: column;
            display: flex;
            overflow-x: hidden;
        }

        .aui-bar-nav {
            top: 0;
            z-index: 1;
            background-color: #0c9ff4;
            color: #FFF;
            font-size: var(--fontsize9);
            font-weight: normal;
            font-stretch: normal;
            letter-spacing: 0rem;
        }

        .aui-bar-nav .aui-btn .aui-iconfont {
            color: #FFF;
            font-weight: 900;
        }

        .aui-tab {
            width: 100%;
            border-bottom: solid 0.03rem #e6e6e6;
        }

        .aui-tab-item {
            font-size: var(--fontsize7);
            font-weight: normal;
            font-stretch: normal;
            letter-spacing: 0vw;
            color: #333333;
        }

        .aui-tab-item.aui-active {
            border-bottom: 0.05rem solid #0c9ff4;
        }

        .aui-tab-item.aui-active,
        .aui-tab-item.aui-active .aui-iconfont {
            color: #0c9ff4;
        }

        .aui-tab-item .aui-iconfont {
            color: #999999;
            font-weight: 900;
            margin-left: 0.15rem;
        }

        .aui-card-list-header {
            padding: 4.13vw 3.2vw;
            font-size: var(--fontsize8);
            font-weight: normal;
            font-stretch: normal;
            letter-spacing: 0vw;
            color: #262626;
        }

        .timeIcon {
            width: 4.27vw;
            height: 4.27vw;
            background-image: url('../../../../image/decision/time.png');
            background-size: 100% 100%;
        }

        .aui-card-list-header input {
            width: 74.67vw;
            height: 7.73vw;
            border-radius: 0.4vw;
            border: solid 0.13vw #dcdcdc;
            font-size: var(--fontsize7);
            font-weight: normal;
            font-stretch: normal;
            letter-spacing: 0.4vw;
            color: #262626;
            padding: 2vw 3.33vw;
        }

        .downArrow {
            width: 2.93vw;
            height: 1.6vw;
            position: absolute;
            top: 7.2vw;
            right: 6.27vw;
            background-image: url('../../../image/decision/downArrow.png');
            background-size: 100% 100%;
        }

        .close {
            width: 3.0vw;
            height: 3.0vw;
            position: absolute;
            top: 6.5vw;
            right: 8.27vw;
            background-image: url('../../../image/message_frame/close2.png');
            background-size: 100% 100%;
        }

        section {
            -webkit-box-flex: 1;
            -webkit-flex: 1;
            flex: 1;
            overflow-y: auto;
            overflow-x: hidden;
            -webkit-overflow-scrolling: touch;
        }

        .tab_display {
            display: none;
        }
        /*tab1*/

        .Tab_content {
            background: #F0F0F0;
        }

        .User_Tabs {
          width: 17rem;
          height: 8.9rem;
          background-color: #ffffff;
         border: 1px solid #fff;
         border-radius: 0.3rem;
         margin: 0.75rem auto;
        }

        .span_title {
            font-size: var(--fontsize7);
            font-family: PingFang-SC-Bold;
            color: #fff;
        }

        .span_number {
            font-family: PingFang-SC-Bold;
            font-size: 0.9rem;
            color: #ffffff;
        }

        .User_Tabs .aui-col-xs-5 .aui-col-xs-12 {
            height: 9.47vw;
            line-height: 9.47vw;
        }

        .User_Tabs .aui-col-xs-5 {
            width: 7.65rem;
            height: 3.55rem;
            border-radius: 0.3rem;
        }

        .User_Tabs .aui-col-xs-5:first-child {
          margin: 0.5rem 0.59rem 0 0.5rem;
          background-color: #5fd7af;
        }

        .User_Tabs .aui-col-xs-5:nth-child(2) {
            margin: 0.5rem 0.5rem 0 0;
            background-color: #10cbee;
        }

        .User_Tabs .aui-col-xs-5:nth-child(3) {
            margin: 0.5rem 0.59rem 0 0.5rem;
            background-color: #aeb9f6;
        }

        .User_Tabs .aui-col-xs-5:last-child {
            margin: 0.5rem 0.5rem 0 0;
            background-color: #fdc491;
        }
        /*图标外面边框*/

        .Tab_content {
            background: #F0F0F0;
            padding-bottom: 0.75rem;
        }

        .echartMarigin {
            width: 93.6vw;
            height: 100%;
            background-color: #ffffff;
            border-radius: 1.33vw;
            border: solid 1px #ffffff;
            margin: 3vw auto;
        }

        .echartMarigin .aui-col-xs-6 {
            height: 10vw;
            line-height: 10vw;
        }

        .span_border_l {
            border-left: 3px solid #0c9ff4;
            margin-left: 0.75rem;
            margin-right: 0.3rem;
        }

        .echarts_title {
            font-family: PingFang-SC-Medium;
            font-size: var(--fontsize7);
            color: #0c9ff4;
        }

        .more {
            font-family: PingFang-SC-Medium;
            font-size: 3.99vw;
            color: #999999;
            margin-right: 0.5rem;
        }

        .noData {
            width: 100%;
            height: 60vw;
            line-height: 53vw;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--fontsize7);
            font-weight: normal;
            font-stretch: normal;
            letter-spacing: 0vw;
            color: #0c9ff4;
            text-align: cnt;
            text-align: center;
        }
        /*tab2*/

        .Table_Title {
            height: 10vw;
            line-height: 10vw;
            border-bottom: 1 solid #FDFAFA;
        }

        .Table_Title span {
            font-family: MicrosoftYaHei;
            font-size: var(--fontsize7);
            color: #333333;
            font-weight: 800;
        }

        .Table_Content {
            height: 8vw;
            line-height: 8vw;
        }

        .Table_Content span {
            font-family: MicrosoftYaHei;
            font-size: var(--fontsize7);
            color: #333333;
        }

        .Content_table .aui-col-xs-4,
        .Table_Content .aui-col-xs-4 {
            text-align: center;
        }
    </style>
</head>

<body>
    <header class="aui-bar aui-bar-nav" id="header">
        <div class="aui-pull-left aui-btn" tapmode data-action='back'>
            <span class="aui-iconfont aui-icon-left"></span>
        </div>
        <div class="aui-title">档案管理统计</div>
    </header>
    <div class="aui-tab" id="tab">
        <div class="aui-tab-item aui-active" tapmode="" data-item-order="1">概况</div>
        <div class="aui-tab-item" tapmode="" data-item-order="2">水表类型</div>
        <div class="aui-tab-item" tapmode="" data-item-order="3">用水性质</div>
        <div class="aui-tab-item" tapmode="" data-item-order="4"> 水表口径</div>
    </div>

    <section class='Tab_content'>
        <!--报装工单开始 -->
        <div class="tab1">
            <div class="aui-row User_Tabs">
                <div class="aui-col-xs-5">
                    <div class="aui-col-xs-12 aui-padded-l-15">
                        <span class="span_title">统计用户</span>
                    </div>
                    <div class="aui-col-xs-12 aui-text-center">
                        <span class='span_number' id="userTotal"></span>
                    </div>

                </div>
                <div class="aui-col-xs-5">
                    <div class="aui-col-xs-12 aui-padded-l-15">
                        <span class="span_title">本年新增</span>
                    </div>
                    <div class="aui-col-xs-12 aui-text-center">
                        <span class='span_number' id="yearUserCount"></span>
                    </div>
                </div>
                <div class="aui-col-xs-5">
                    <div class="aui-col-xs-12 aui-padded-l-15">
                        <span class="span_title">本月新增</span>
                    </div>
                    <div class="aui-col-xs-12 aui-text-center">
                        <span class='span_number' id="monthUserCount"></span>
                    </div>

                </div>
                <div class="aui-col-xs-5">
                    <div class="aui-col-xs-12 aui-padded-l-15">
                        <span class="span_title">本季新增</span>
                    </div>
                    <div class="aui-col-xs-12 aui-text-center">
                        <span class='span_number' id="quarterUserCount"></span>
                    </div>
                </div>

            </div>
            <div class="echartMarigin">
                <div class="aui-row">
                    <div class="aui-col-xs-6"><span class="span_border_l"></span><span class="echarts_title">新增用户趋势</span></div>

                </div>
                <div id="tab1Echart1" style="width:100%;">
                </div>
                <div class="noData aui-show">
                    暂无数据！
                </div>
            </div>
            <div class="echartMarigin">
                <div class="aui-row">
                    <div class="aui-col-xs-6"><span class="span_border_l"></span><span class="echarts_title">用户(累计)状态分析</span></div>

                </div>
                <div id="tab1Echart2" style="width:100%;">
                </div>
                <div class="noData aui-show">
                    暂无数据！
                </div>
            </div>

        </div>
        <div class="tab_display tab2">
            <div class="echartMarigin">
                <div class="aui-row">
                    <div class="aui-col-xs-10"><span class="span_border_l"></span><span class="echarts_title">水表类型分析（当月新增用户）</span></div>

                </div>
                <div id="tab2Echart1" style="width:100%;">
                </div>
                <div class="noData aui-show">
                    暂无数据！
                </div>
            </div>
            <div class="echartMarigin">
                <div class="aui-row">
                    <div class="aui-col-xs-10"><span class="span_border_l"></span><span class="echarts_title">水表类型分析（累计用户）</span></div>
                </div>
                <div id="tab2Echart2" style="width:100%;">
                </div>
                <div class="noData aui-show">
                    暂无数据！
                </div>
            </div>
        </div>
        <div class="tab_display tab3">
            <div class="echartMarigin">
                <div class="aui-row">
                    <div class="aui-col-xs-9"><span class="span_border_l"></span><span class="echarts_title">
用水性质分析（当月新增用户）</span></div>
                    <div class="aui-col-xs-3 aui-text-right" id="tab3mMore1" data-action='openWins'><span class="more">更多></span></div>
                </div>
                <div id="tab3Echart1" style="width:100%;">
                </div>
                <div class="noData aui-show">
                    暂无数据！
                </div>
            </div>
            <div class="echartMarigin">
                <div class="aui-row">
                    <div class="aui-col-xs-9"><span class="span_border_l"></span><span class="echarts_title">用水性质分析（累计用户）</span></div>
                    <div class="aui-col-xs-3 aui-text-right" id="tab3mMore2" data-action='openWins'><span class="more">更多></span></div>
                </div>
                <div id="tab3Echart2" style="width:100%;">
                </div>
                <div class="noData aui-show">
                    暂无数据！
                </div>
            </div>
        </div>
        <div class="tab_display tab4">
            <div class="echartMarigin">
                <div class="aui-row">
                    <div class="aui-col-xs-10"><span class="span_border_l"></span><span class="echarts_title">水表类型分析（当月新增用户）</span></div>

                </div>
                <div id="tab4Echart1" style="width:100%;">
                </div>
                <div class="noData aui-show">
                    暂无数据！
                </div>
            </div>
            <div class="echartMarigin">
                <div class="aui-row">
                    <div class="aui-col-xs-10"><span class="span_border_l"></span><span class="echarts_title">水表类型分析（累计用户）</span></div>
                </div>
                <div id="tab4Echart2" style="width:100%;">
                </div>
                <div class="noData aui-show">
                    暂无数据！
                </div>
            </div>
        </div>

        <!-- 报装工单结束 -->

    </section>

</body>
<script type="text/javascript" src="../../../script/api.js"></script>
<script type="text/javascript" src="../../../script/common.js"></script>
<script type="text/javascript" src="../../../script/diy/public.js"></script>
<script type="text/javascript" src="../../../script/remote.js"></script>
<script type="text/javascript" src="../../../script/aui-tab.js"></script>
<script type="text/javascript" src="../../../script/rolldate.js"></script>
<script type="text/javascript" src="../../../script/echarts.min.js"></script>
<script type="text/javascript" src="../../../script/zepto.js"></script>
<script type="text/javascript" src="../../../script/CustomerService.js"></script>
<script type="text/javascript" src="../../../script/moment.js"></script>
<script type="text/javascript">
    document.body.addEventListener('touchstart', function() {});
    apiready = function() {
        api.addEventListener({
            name: 'changedFontSize'
        }, function(ret, err) {
            if (ret) {
                changeFontSize();
            }
        });
        api.parseTapmode();
        var header = $api.byId('header');
        // 实现沉浸式状态栏效果
        $api.fixStatusBar(header);
        headerH = $api.offset(header).h;
        fnReady();
        // 用户统计
        GetUserCountInterFace();
    };

    // 单击
    operationDom();
    var actionList = {
        'back': function() {
            api.closeWin();
        },
        'openWins': function() {
            var Id = $(this).attr('id');
            var param = $(this).attr('param');
            if (Id == 'tab3mMore1') {
                if (param) {
                    api.openWin({
                        name: 'tabMore',
                        url: '../FileCounts/tabMore.html',
                        pageParam: {
                            name: param
                        }
                    });
                } else {
                    api.toast({
                        msg: '暂无数据！',
                        duration: 2000,
                        location: 'bottom'
                    });

                }
            } else if (Id == 'tab3mMore2') {
                if (param) {
                    api.openWin({
                        name: 'tabMore',
                        url: '../FileCounts/tabMore.html',
                        pageParam: {
                            name: param
                        }
                    });
                } else {
                    api.toast({
                        msg: '暂无数据！',
                        duration: 2000,
                        location: 'bottom'
                    });

                }
            }
        }
    }

    // tab切换
    // tab切换
    var tab = new auiTab({
        element: document.getElementById("tab"),
    }, function(ret) {
        $('.tab' + ret.index).show();
        $('.tab' + ret.index).siblings().hide();
        if (ret.index == 1) {
            GetUserCountInterFace();
        } else if (ret.index == 2) {
            Filetab2();
        } else if (ret.index == 3) {
            Filetab3();
        } else if (ret.index == 4) {
            Filetab4();
        }
    });

    function GetUserCountInterFace() {
        fnGet('services/Report/Archive/GetUserCount', {}, false, function(ret, err) {
            if (ret) {
                if (ret.success && ret.result != null) {
                    $('#userTotal').html(ret.result.userTotal);
                    $('#yearUserCount').html(ret.result.yearUserCount);
                    $('#quarterUserCount').html(ret.result.quarterUserCount);
                    $('#monthUserCount').html(ret.result.monthUserCount);
                } else {
                    api.toast({
                        msg: '暂无数据！',
                        duration: 2000,
                        location: 'bottom'
                    });

                }
            }
        });
        //  新增用户趋势
        fnGet('services/Report/Archive/GetAddUserTrend', {}, false, function(ret, err) {
            if (ret) {
                if (ret.success && ret.result != null) {
                    $('#tab1Echart1').siblings('.noData').removeClass('aui-show').addClass('aui-hide');
                    var Echarts = echarts.init(document.getElementById('tab1Echart1'));
                    var nameList = ret.result.nameList;
                    var dataList = ret.result.dataList;
                    var option = {
                        color: '#0c9ff4',
                        tooltip: {
                            trigger: 'axis',
                            axisPointer: {
                                type: 'cross',
                                crossStyle: {
                                    color: '#999'
                                }
                            },
                            formatter: '{b}<br/>新增用户: {c}个'
                        },
                        grid: {
                            left: '5%',
                            right: '15%',
                            bottom: '5%',
                            top: '15%',
                            containLabel: true
                        },
                        xAxis: {
                            name: '(月份)',
                            axisTick: {
                                show: false
                            },
                            axisLine: {
                                show: false
                            },
                            type: 'category',
                            data: ['01', '02', '03', '04', '05', '06', '07', '08', '09', '10', '11', '12'],

                        },
                        yAxis: {
                            type: 'value',
                            name: '(个)',
                            axisTick: {
                                show: false
                            },
                            axisLine: {
                                show: false
                            },

                            axisLabel: {
                                formatter: '{value}'
                            }

                        },
                        series: [{
                                type: 'bar',
                                data: dataList
                            },
                            // {
                            //
                            //     type: 'line',
                            //     yAxisIndex: 0,
                            //     data: [2.0, 2.2, 3.3, 4.5, 6.3, 10.2, 20.3, 23.4, 23.0, 16.5, 12.0, 6.2]
                            // }
                        ]
                    };
                    Echarts.setOption(option, true);
                    var autoHeight = 3 * 50 + 50; // counst.length为柱状图的条数，即数据长度。35为我给每个柱状图的高度，50为柱状图x轴内容的高度(大概的)。
                    Echarts.getDom().style.height = autoHeight + "px";
                    Echarts.resize();

                } else {
                    $('#tab2Echart1').siblings('.noData').removeClass('aui-hide').addClass('aui-show');

                }
            }
        });
        //  用户状态分析
        fnGet('services/Report/Archive/GetUserStatusStatistics', {}, false, function(ret, err) {
            if (ret) {
                if (ret.success && ret.result != null) {
                    $('#tab1Echart2').siblings('.noData').removeClass('aui-show').addClass('aui-hide');
                    var Echarts = echarts.init(document.getElementById('tab1Echart2'));
                    var pieChartList = ret.result;
                    var seriesDatas = [];
                    var legendDatas = [];
                    for (var i = 0; i < pieChartList.length; i++) {
                        seriesDatas.push({
                            value: pieChartList[i].value,
                            name: pieChartList[i].name
                        });
                        legendDatas.push(pieChartList[i].name);
                    }
                    var option = {
                        color: ['#2BB0FD', '#10E1C4', '#7FD709', '#FDEF4D', '#FDC963', '#FFA75D', '#FD7A72', '#FE4747', '#FF61D2', '#B962FE', '#5B5AE9', '#2A8AFB'],
                        tooltip: {
                            trigger: 'item',
                            formatter: "{a} <br/>{b}: {c} ({d}%)"
                        },
                        legend: {
                            orient: 'horizontal',
                            icon: 'circle',
                            x: '10%',
                            y: '80%',
                            bottom: '25%',
                            data: legendDatas
                        },
                        series: [{
                            name: '用户状态分析',
                            type: 'pie',
                            radius: ['40%', '60%'],
                            center: ['50%', '40%'],
                            avoidLabelOverlap: false,
                            label: {
                                normal: {
                                    show: false,
                                    position: 'center'
                                },
                                emphasis: {
                                    show: true,
                                    textStyle: {
                                        fontSize: '15',
                                        fontWeight: 'bold'
                                    }
                                }
                            },
                            labelLine: {
                                normal: {
                                    show: true
                                }
                            },
                            data: seriesDatas
                        }]
                    };
                    Echarts.setOption(option, true);
                    var autoHeight = 3 * 50 + 50; // counst.length为柱状图的条数，即数据长度。35为我给每个柱状图的高度，50为柱状图x轴内容的高度(大概的)。
                    Echarts.getDom().style.height = autoHeight + "px";
                    Echarts.resize();
                } else {
                    $('#tab2Echart2').siblings('.noData').removeClass('aui-hide').addClass('aui-show');

                }
            }
        });

    }
</script>

</html>
